

# 프로세스의 구조
- 운영체제는 프로세스에서 생성, 종료, 제거, 중단(서스펜드), 재시작, 우선순위, 변경, 대기, 문맥 교환 등 다양한 작업을 수행할 수 있다.
- 이는 먼저 프로세스의 구조를 알아야 이해할 수 있다.
- 프로세스는 실행 중에 프로세스 생성 시스템 호출을 이용하여 새로운 프로세스를 생성할 수 있다.
- 이때 프로세스 생성 순서를 저장하고 부모-자식 관계를 유지하여 계층적으로 생성한다.
- 프로세스를 새로 생성하는 프로세스는 부모 프로세스이고, 생성되는 프로세느는 자식 프로세스 또는 서브 프로세스이다.
- 부모 프로세스는 자식 프로세스를 생성하는 과정을 반복하면서 계층 구조를 형성한다.

![프로세스의 구조.png](..%2F..%2Fetc%2Fimage%2FOS_IMAGE%2F%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%9D%98%20%EA%B5%AC%EC%A1%B0.png) 


### 프로세스의 생성
- 운영체제나 응용 프로그램에서 요청을 받아 프로세스를 생성하면, 운영체제는 해당 프로세스에서 프로세스 제어 블록(PCB)을 만들어 주소 공간을 할당한다.
- 일괄 처리 환경에서는 준비 큐에 작업이 도착할 때 프로세스를 생성하고, 대화형 환경에서는 새로운 사용자가 로그온할 때 프로세스를 생성한다.
- 예를 들어, 사용자 요청에 따라 프린터를 구동하는 프로세스를 생성하면 해당 프로세스의 식별자를 결정하고, 우선순위를 부여하고, 프로세스 제어 블록을 생성(할당ㅇ된 자원, 자원 리스트 등 정보 기록)하고, 초기 자원을 할당한 후 준비 상태가 되어 준비리스트의 마지막에 위치한다.

#### 단계별 프로세스 세부 작업 단계
1. 새로운 프로세스에 프로세스 식별자를 할당한다.
2. 프로세스의 모든 구성 요소를 포함할 수 있는 주소 공간과 프로세스 제어 블록 공간을 할당한다.
3. 프로세스 제어 블록을 초기화한다. 프로세스 상태, 프로그램 카운터 등 초기화, 자원 요청, 프로세스 제어 정보(우선순위) 등을 포함한다.
4. 링크를 건다(해당 큐에 삽입한다.)

- 자식 프로세스는 운영체제에서 직접 필요한 자원을 얻거나 부모 프로세스와 자원을 일부 사용할 수 있다.
- 이때 부모 프로세스는 자식 프로세스가 사용하는 자원을 제한해서 특정 프로세스가 자식 프로세스를 너무 많이 생성하여 시스템에 부담을 주는 것을 막을 수 있다.

#### 프로세스가 새로운 프로세스를 생성할 때 다음 두가지 실행이 발생할 수 있다.
- 부모 프로세스와 자식 프로세스를 동시에 실행한다.
- 부모 프로세스는 자식 프로세스를 모두 종료할 때까지 기다린다.

### 프로세스의 종료
- 프로세스가 마지막 명령을 실행하면 종료하여 운영체제에 프로세스의 삭제를 요청한다.
- 일괄처리 환경에서는 작업 종료를 의미하는 신호로 인터럽트를 발생하거나 시스템 호출로 중단명령을 전달하여 프로세스를 종료한다.

#### abort 명령어
- 종료할 프로세스의 부모 프로세스만 호출하는데, 부모가 아닌 다른 프로세스가 임의로 해당 프로세스를 중단할 수 없기 때문이다.
- 그리고 자식 프로세스는 종료할 때 자신의 식별자를 부모 프로세스에 전달한다.

#### 다양한 이유로 종료할 수 있는데, 다음은 몇 가지 예이다.
- **정상 종료** : 프로세스가 운영체제의 서비스를 호출할 때
- **시간 초과** : 프로세스가 명시된 전체 시간을 초과하여 실행하거나 명시된 시간을 초과하면서 어떤 이벤트 발생을 기다릴 때
- **실패** : 파일 검색 실패, 입출력이 명시된 횟수를 초과하여 실패할 때
- 산술오류, 보호 오류, 데이터 오류 등 
- 메모리 부족, 엑세스 위반 등

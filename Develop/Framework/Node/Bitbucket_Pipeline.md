
# ğŸš€ Node.js Bitbucket Pipeline

---

## 1. Bitbucket Pipelineì´ë€?
**Bitbucket Pipeline**ì€ Bitbucketì—ì„œ ì œê³µí•˜ëŠ” **CI/CD (ì§€ì†ì  í†µí•© ë° ì§€ì†ì  ë°°í¬)** ë„êµ¬ì…ë‹ˆë‹¤.  
Git ì €ì¥ì†Œì— ì½”ë“œë¥¼ í‘¸ì‹œí•  ë•Œ **ìë™ìœ¼ë¡œ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬**ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

### ğŸ‘‰ğŸ» Bitbucket Pipelineì˜ ì£¼ìš” íŠ¹ì§•
- **ìë™í™”**: ì½”ë“œ í‘¸ì‹œ ì‹œ ìë™ìœ¼ë¡œ ë¹Œë“œ ë° ë°°í¬ ìˆ˜í–‰.
- **ë‚´ì¥ CI/CD**: ë³„ë„ ë„êµ¬ ì„¤ì¹˜ ì—†ì´ Bitbucketì—ì„œ ì§ì ‘ ì‚¬ìš©.
- **YAML ê¸°ë°˜ êµ¬ì„±**: `bitbucket-pipelines.yml` íŒŒì¼ë¡œ ì†ì‰½ê²Œ ì„¤ì •.
- **ë‹¤ì¤‘ ì–¸ì–´ ì§€ì›**: Node.js, Python, Java ë“± ë‹¤ì–‘í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ì§€ì›.

---

## 2. Bitbucket Pipelineì˜ ê¸°ë³¸ êµ¬ì„± ğŸ“¦
**Bitbucket Pipeline**ì€ ì €ì¥ì†Œì˜ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì— ìœ„ì¹˜í•˜ëŠ” **`bitbucket-pipelines.yml`** íŒŒì¼ì„ í†µí•´ êµ¬ì„±ë©ë‹ˆë‹¤.

### ğŸ“‚ Node.js í”„ë¡œì íŠ¸ì˜ ê¸°ë³¸ ì˜ˆì œ
```yaml
# ì‚¬ìš©í•  Node.js ë²„ì „ Docker ì´ë¯¸ì§€ ì§€ì •
image: node:14  

pipelines:
  default:  # ëª¨ë“  ë¸Œëœì¹˜ì— ëŒ€í•´ ì‹¤í–‰
    - step:
        name: 'Install and Test'  # ë‹¨ê³„ ì´ë¦„
        caches:
          - node  # npm íŒ¨í‚¤ì§€ ìºì‹œ
        script:  # ì‹¤í–‰í•  ëª…ë ¹ì–´ë“¤
          - npm install  # íŒ¨í‚¤ì§€ ì„¤ì¹˜
          - npm test     # ìœ ë‹› í…ŒìŠ¤íŠ¸ ì‹¤í–‰

  branches:  # íŠ¹ì • ë¸Œëœì¹˜ì— ëŒ€í•œ ê·œì¹™ ì„¤ì •
    main:
      - step:
          name: 'Deploy to Production'  # ë©”ì¸ ë¸Œëœì¹˜ì— ë°°í¬
          script:
            - npm run build  # í”„ë¡œì íŠ¸ ë¹Œë“œ
            - scp -r ./dist user@server:/var/www/myapp  # ì„œë²„ì— ë°°í¬
```

---

## 3. Bitbucket Pipelineì˜ êµ¬ì„± ìš”ì†Œ ğŸ“¦
### ğŸ“Œ `image`
- ì‚¬ìš©í•  **Docker ì´ë¯¸ì§€**ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
- ì˜ˆ: `node:14`, `python:3.9`

### ğŸ“Œ `pipelines`
- **ì „ì²´ íŒŒì´í”„ë¼ì¸ ì›Œí¬í”Œë¡œìš°**ë¥¼ ì •ì˜í•˜ëŠ” ì„¹ì…˜ì…ë‹ˆë‹¤.

### ğŸ“Œ `default`
- ëª¨ë“  ë¸Œëœì¹˜ì— ëŒ€í•´ ì‹¤í–‰ë˜ëŠ” ê¸°ë³¸ íŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤.

### ğŸ“Œ `branches`
- íŠ¹ì • ë¸Œëœì¹˜ì— ëŒ€í•´ ì‹¤í–‰ë  ê·œì¹™ì„ ì •ì˜í•©ë‹ˆë‹¤.

### ğŸ“Œ `step`
- **ê° ë‹¨ê³„**ë¥¼ ì •ì˜í•˜ëŠ” ë¸”ë¡ì…ë‹ˆë‹¤.

### ğŸ“Œ `script`
- ê° ë‹¨ê³„ì—ì„œ ì‹¤í–‰í•  **ì‰˜ ëª…ë ¹ì–´**ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

### ğŸ“Œ `caches`
- ë¹Œë“œ ì†ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ **ìºì‹œ**ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì˜ˆ: `node` (npm íŒ¨í‚¤ì§€ ìºì‹œ)

---

## 4. Node.js CI/CD ì˜ˆì œ ğŸ› ï¸
### ğŸ“¦ 4.1 Node.js í”„ë¡œì íŠ¸ ìë™í™” (í…ŒìŠ¤íŠ¸ + ë¹Œë“œ + ë°°í¬)
```yaml
image: node:16

pipelines:
  default:
    - step:
        name: 'Install and Run Tests'
        caches:
          - node
        script:
          - npm install
          - npm test

  branches:
    main:
      - step:
          name: 'Build and Deploy to Production'
          script:
            - npm run build
            - scp -r ./dist user@my-production-server:/var/www/myapp
```

### ğŸ“Œ ì„¤ëª… (í•œ ì¤„ì”© í•´ì„¤)
- `image: node:16` â†’ Node.js 16 ë²„ì „ì˜ Docker ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©.
- `default` â†’ ëª¨ë“  ë¸Œëœì¹˜ì— ëŒ€í•´ ì‹¤í–‰.
- `step` â†’ ê°œë³„ ë‹¨ê³„ë¥¼ ì •ì˜.
- `caches` â†’ `node_modules`ë¥¼ ìºì‹œí•˜ì—¬ ì†ë„ ìµœì í™”.
- `script` â†’ `npm install`ë¡œ ì˜ì¡´ì„± ì„¤ì¹˜, `npm test`ë¡œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰.
- `main` â†’ `main` ë¸Œëœì¹˜ì— í‘¸ì‹œ ì‹œ `npm run build`ì™€ `scp`ë¥¼ ì´ìš©í•´ í”„ë¡œë•ì…˜ ë°°í¬.

---

### âœ… 4.2 Node.js í”„ë¡œì íŠ¸ + AWS S3 ë°°í¬ ì˜ˆì œ
```yaml
image: node:14

pipelines:
  default:
    - step:
        name: 'Build and Deploy to S3'
        script:
          - npm install
          - npm run build
          - aws s3 sync ./dist s3://my-bucket-name --delete
          - aws cloudfront create-invalidation --distribution-id EXAMPLE_ID --paths "/*"
```

---

## 5. Bitbucket Pipelineì˜ ë³´ì•ˆ ì„¤ì • ğŸ”’
### âœ… ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€
- **IAM ìµœì†Œ ê¶Œí•œ ì‚¬ìš©**: AWS ìê²© ì¦ëª… ìµœì†Œ ê¶Œí•œ ë¶€ì—¬.
- **í™˜ê²½ ë³€ìˆ˜ ë³´í˜¸**: `Repository Settings â†’ Environment Variables` ì‚¬ìš©.
- **ë³´ì•ˆ í† í° ì•”í˜¸í™”**: `secrets` ê´€ë¦¬ ì‚¬ìš©.

---

## 6. Bitbucket Pipelineì˜ ì¥ë‹¨ì  ğŸ“Š
### âœ… ì¥ì 
- **ë‚´ì¥ CI/CD**: ì¶”ê°€ ë„êµ¬ ì„¤ì¹˜ ì—†ì´ ì‚¬ìš© ê°€ëŠ¥.
- **ê°„í¸í•œ ì„¤ì •**: YAML íŒŒì¼ë§Œìœ¼ë¡œ ê°„ë‹¨íˆ êµ¬ì„±.
- **ë¬´ë£Œ í”Œëœ ì œê³µ**: ì†Œê·œëª¨ í”„ë¡œì íŠ¸ ë¬´ë£Œ ì‚¬ìš© ê°€ëŠ¥.

### â— ë‹¨ì 
- **ê³ ê¸‰ ì›Œí¬í”Œë¡œìš° ì œí•œ**: Jenkins, GitLab CIì— ë¹„í•´ ê¸°ëŠ¥ ì œí•œ.
- **ì»¤ìŠ¤í„°ë§ˆì´ì§• ì œí•œ**: ë³µì¡í•œ íŒŒì´í”„ë¼ì¸ êµ¬ì„± ì–´ë ¤ì›€.

---

## 7. Bitbucket Pipeline ì‚¬ìš© ì‚¬ë¡€ ğŸ“¦
- **Node.js í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸ ë° ë°°í¬**
- **ì •ì  ì›¹ì‚¬ì´íŠ¸ S3 + CloudFront ë°°í¬**
- **ì„œë²„ë¦¬ìŠ¤ Lambda í•¨ìˆ˜ ìë™ ë°°í¬**
- **Docker ì»¨í…Œì´ë„ˆ ë¹Œë“œ ë° ECR í‘¸ì‹œ**

---

## 8. Bitbucket Pipelineê³¼ GitHub Actions ë¹„êµ
| **íŠ¹ì§•**                   | **Bitbucket Pipelines**      | **GitHub Actions**      |
|:---------------------------|:----------------------------|:------------------------|
| **í†µí•© ë°©ì‹**              | Bitbucketì— ë‚´ì¥           | GitHubì— ë‚´ì¥          |
| **ì‚¬ìš© ìš©ì´ì„±**             | ê°„í¸í•¨                    | ë‹¤ì†Œ ë³µì¡í•¨            |
| **ë¬´ë£Œ í”Œëœ ì œê³µ**         | 50ë¶„/ì›” ë¬´ë£Œ               | 2,000ë¶„/ì›” ë¬´ë£Œ         |
| **ì»¤ìŠ¤í„°ë§ˆì´ì§•**           | ì œí•œì                     | ê³ ê¸‰ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥   |

---

## 9. ê²°ë¡  âœ…
- **Bitbucket Pipeline**ì€ **Node.js í”„ë¡œì íŠ¸ì˜ CI/CDë¥¼ ê°„í¸í•˜ê²Œ ìë™í™”**í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤.
- **`bitbucket-pipelines.yml`** íŒŒì¼ í•˜ë‚˜ë¡œ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ë¥¼ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€**ë¥¼ ì¤€ìˆ˜í•˜ê³ , **í™˜ê²½ ë³€ìˆ˜ ë³´í˜¸**ë¥¼ ê°•í™”í•´ì•¼ í•©ë‹ˆë‹¤.

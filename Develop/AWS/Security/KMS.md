# AWS KMS μ™„μ „μ •λ³µ! π”

μ•λ…•ν•μ„Έμ”! μ¤λμ€ λ§μ€ λ¶„λ“¤μ΄ κ¶κΈν•΄ν•μ‹λ” AWS KMS(Key Management Service)μ— λ€ν•΄ μ•„μ£Ό~ μμ„Έν•κ² νν—¤μ³λ³΄λ ¤κ³  ν•©λ‹λ‹¤. β•οΈ ν΄λΌμ°λ“ λ³΄μ•μ— κ΄€μ‹¬μ΄ μλ‹¤λ©΄ κΌ­ μ•μ•„μ•Ό ν•  μ„λΉ„μ¤μ΄λ‹, λκΉμ§€ μ½μ–΄λ³΄μ‹λ©΄ λ¶„λ… λ„μ›€μ΄ λ  κ±°μμ”!

---

## 1. KMSλ€ λ¬΄μ—‡μΈκ°€μ”? π¤”

KMSλ” Key Management Serviceμ μ•½μλ΅, AWSμ—μ„ μ κ³µν•λ” μ™„μ „κ΄€λ¦¬ν• ν‚¤ κ΄€λ¦¬ μ„λΉ„μ¤μ…λ‹λ‹¤. μ‰½κ² λ§ν•΄, λ°μ΄ν„° μ•”νΈν™”μ— ν•„μ”ν• ν‚¤λ¥Ό μ•μ „ν•κ² μƒμ„±, μ €μ¥, κ΄€λ¦¬, μ‚¬μ©, νκΈ°κΉμ§€ ν•΄μ£Όλ” μ„λΉ„μ¤μ£ . π”‘

### 1-1. μ™ KMSκ°€ ν•„μ”ν• κΉμ”?

ν΄λΌμ°λ“ ν™κ²½μ—μ„λ” λ°μ΄ν„°κ°€ μ—¬λ¬ κ³³μ— μ €μ¥λκ³ , λ‹¤μ–‘ν• μ„λΉ„μ¤μ™€ μ—°λ™λ©λ‹λ‹¤. μ΄λ• λ°μ΄ν„°κ°€ μ μ¶λκ±°λ‚ λ³€μ΅°λλ” κ²ƒμ„ λ§‰κΈ° μ„ν•΄ μ•”νΈν™”κ°€ ν•„μμ…λ‹λ‹¤. ν•μ§€λ§ μ•”νΈν™”μ ν•µμ‹¬μΈ "ν‚¤"λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬ν•λ” κ±΄ μƒκ°λ³΄λ‹¤ μ–΄λ µμ£ . π… κ·Έλμ„ AWSκ°€ KMSλ¥Ό λ§λ“¤μ–΄, ν‚¤ κ΄€λ¦¬μ λ³µμ΅ν•¨μ„ λ€μ‹  ν•΄κ²°ν•΄μ¤λ‹λ‹¤!

---

## 2. KMSμ μ£Όμ” κΈ°λ¥ π

### 2-1. ν‚¤ μƒμ„± λ° κ΄€λ¦¬
- λ€μΉ­ν‚¤(Symmetric Key)μ™€ λΉ„λ€μΉ­ν‚¤(Asymmetric Key) λ¨λ‘ μ§€μ›
- ν‚¤μ μƒμ„±, ν™μ„±ν™”/λΉ„ν™μ„±ν™”, μ‚­μ , λ΅ν…μ΄μ… λ“± λ‹¤μ–‘ν• κ΄€λ¦¬ κΈ°λ¥ μ κ³µ

### 2-2. λ°μ΄ν„° μ•”νΈν™”/λ³µνΈν™”
- KMSμ—μ„ μ§μ ‘ μ•”νΈν™”/λ³µνΈν™” API μ κ³µ
- S3, EBS, RDS λ“± AWS μ„λΉ„μ¤μ™€ μ—°λ™ν•μ—¬ μλ™ μ•”νΈν™” κ°€λ¥

### 2-3. μ ‘κ·Ό μ μ–΄
- IAM μ •μ±…, ν‚¤ μ •μ±…, κ·ΈλνΈ(Grant) λ“± λ‹¤μ–‘ν• λ°©μ‹μΌλ΅ ν‚¤ μ ‘κ·Ό κ¶ν• μ μ–΄
- μ„Έλ¶„ν™”λ κ¶ν• μ„¤μ •μΌλ΅ λ³΄μ• κ°•ν™”

### 2-4. κ°μ‚¬ λ° λ΅κΉ…
- CloudTrailκ³Ό μ—°λ™ν•μ—¬ ν‚¤ μ‚¬μ© μ΄λ ¥ μ¶”μ  κ°€λ¥
- λ„κ°€, μ–Έμ , μ–΄λ–¤ ν‚¤λ¥Ό μ‚¬μ©ν–λ”μ§€ ν™•μΈ κ°€λ¥ π‘€

---

## 3. KMSμ κµ¬μ΅°μ™€ μ©μ–΄ μ •λ¦¬ π—οΈ

### 3-1. CMK(Customer Master Key)
- KMSμ—μ„ κ΄€λ¦¬ν•λ” μ£Όμ” μ•”νΈν™” ν‚¤
- μ‹¤μ  λ°μ΄ν„° μ•”νΈν™”μ— μ§μ ‘ μ‚¬μ©λκΈ°λ³΄λ‹¤λ”, λ°μ΄ν„° ν‚¤(Data Key)λ¥Ό μ•”νΈν™”ν•λ” λ° μ‚¬μ©λ¨

### 3-2. λ°μ΄ν„° ν‚¤(Data Key)
- μ‹¤μ  λ°μ΄ν„° μ•”νΈν™”/λ³µνΈν™”μ— μ‚¬μ©λλ” μΌνμ„± ν‚¤
- CMKλ΅ μ•”νΈν™”λμ–΄ μ €μ¥λ¨

### 3-3. ν‚¤ μ •μ±…(Key Policy)
- κ° ν‚¤μ— λ¶€μ—¬λλ” μ •μ±…μΌλ΅, λ„κ°€ μ–΄λ–¤ μ‘μ—…μ„ ν•  μ μλ”μ§€ μ •μ

### 3-4. κ·ΈλνΈ(Grant)
- μΌμ‹μ μΌλ΅ νΉμ • μ‚¬μ©μ/μ„λΉ„μ¤μ— ν‚¤ μ‚¬μ© κ¶ν•μ„ λ¶€μ—¬ν•λ” κΈ°λ¥

---

## 4. KMS λ™μ‘ μ›λ¦¬ π”„

### 4-1. μ•”νΈν™” κ³Όμ •
1. μ‚¬μ©μκ°€ KMSμ— λ°μ΄ν„° ν‚¤ μƒμ„±μ„ μ”μ²­
2. KMSλ” CMKλ΅ μ•”νΈν™”λ λ°μ΄ν„° ν‚¤(Encrypted Data Key)μ™€ ν‰λ¬Έ λ°μ΄ν„° ν‚¤(Plaintext Data Key)λ¥Ό λ°ν™
3. ν‰λ¬Έ λ°μ΄ν„° ν‚¤λ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”
4. μ•”νΈν™”λ λ°μ΄ν„°μ™€ μ•”νΈν™”λ λ°μ΄ν„° ν‚¤λ¥Ό ν•¨κ» μ €μ¥

### 4-2. λ³µνΈν™” κ³Όμ •
1. μ•”νΈν™”λ λ°μ΄ν„° ν‚¤λ¥Ό KMSμ— μ „λ‹¬
2. KMSκ°€ CMKλ΅ λ³µνΈν™”ν•μ—¬ ν‰λ¬Έ λ°μ΄ν„° ν‚¤ λ°ν™
3. ν‰λ¬Έ λ°μ΄ν„° ν‚¤λ΅ λ°μ΄ν„° λ³µνΈν™”

μ΄λ ‡κ² ν•λ©΄, μ‹¤μ  λ°μ΄ν„° ν‚¤λ” μ•μ „ν•κ² λ³΄νΈλκ³ , λ°μ΄ν„° μ•”νΈν™”/λ³µνΈν™”λ„ κ°„νΈν•κ² ν•  μ μμµλ‹λ‹¤! π

---

## 5. KMSμ™€ AWS μ„λΉ„μ¤ μ—°λ™ μ‚¬λ΅€ π› οΈ

### 5-1. S3 λ²„ν‚· μ•”νΈν™”
- S3μ—μ„ KMS ν‚¤λ¥Ό μ„ νƒν•λ©΄, μ—…λ΅λ“λλ” κ°μ²΄κ°€ μλ™μΌλ΅ μ•”νΈν™”λ¨
- S3 μ½μ†”μ—μ„ κ°„λ‹¨ν μ„¤μ • κ°€λ¥

### 5-2. EBS λ³Όλ¥¨ μ•”νΈν™”
- EC2 μΈμ¤ν„΄μ¤μ EBS λ³Όλ¥¨λ„ KMSλ΅ μ•”νΈν™” κ°€λ¥
- μ¤λƒ…μƒ·, λ³µμ λ³Έ λ“±λ„ μλ™ μ•”νΈν™”

### 5-3. RDS μ•”νΈν™”
- λ°μ΄ν„°λ² μ΄μ¤ μΈμ¤ν„΄μ¤ μƒμ„± μ‹ KMS ν‚¤ μ§€μ • κ°€λ¥
- λ°±μ—…, μ¤λƒ…μƒ·, λ¦¬μ¤ν† μ–΄ λ“±λ„ λ¨λ‘ μ•”νΈν™”

### 5-4. Lambda ν™κ²½ λ³€μ μ•”νΈν™”
- Lambda ν•¨μμ ν™κ²½ λ³€μλ„ KMSλ΅ μ•”νΈν™”ν•μ—¬ μ €μ¥ κ°€λ¥

---

## 6. KMS ν‚¤μ μΆ…λ¥μ™€ μ„ νƒ κΈ°μ¤€ π—οΈ

### 6-1. AWS κ΄€λ¦¬ν• ν‚¤(AWS Managed Key)
- AWSκ°€ μλ™μΌλ΅ μƒμ„±/κ΄€λ¦¬ν•λ” ν‚¤
- S3, EBS λ“±μ—μ„ κΈ°λ³ΈμΌλ΅ μ κ³µ
- μ‚¬μ©μλ” λ³„λ„ κ΄€λ¦¬ ν•„μ” μ—†μ

### 6-2. κ³ κ° κ΄€λ¦¬ν• ν‚¤(Customer Managed Key)
- μ‚¬μ©μκ°€ μ§μ ‘ μƒμ„±/κ΄€λ¦¬ν•λ” ν‚¤
- ν‚¤ μ •μ±…, λ΅ν…μ΄μ…, μ‚­μ  λ“± μ„Έλ¶€ μ„¤μ • κ°€λ¥
- λ³΄μ• μ”κµ¬μ‚¬ν•­μ΄ λ†’μ„ λ• μ¶”μ²

### 6-3. λ€μΉ­ν‚¤ vs λΉ„λ€μΉ­ν‚¤
- λ€μΉ­ν‚¤: μ•”νΈν™”/λ³µνΈν™”μ— κ°™μ€ ν‚¤ μ‚¬μ© (μΌλ°μ )
- λΉ„λ€μΉ­ν‚¤: κ³µκ°ν‚¤/κ°μΈν‚¤ μμΌλ΅ μ•”νΈν™”/λ³µνΈν™” (νΉμ • μ‹λ‚λ¦¬μ¤μ— μ‚¬μ©)

---

## 7. KMS μ‚¬μ© μ‹ μ£Όμμ‚¬ν•­ β οΈ

### 7-1. ν‚¤ μ‚­μ λ” μ‹ μ¤‘ν•κ²!
- ν‚¤λ¥Ό μ‚­μ ν•λ©΄, ν•΄λ‹Ή ν‚¤λ΅ μ•”νΈν™”λ λ°μ΄ν„°λ” μκµ¬μ μΌλ΅ λ³µκµ¬ λ¶κ°€
- μ‚­μ  μ „, 7~30μΌμ λ€κΈ° κΈ°κ°„(μ‚­μ  λ€κΈ°) μ„¤μ • κ°€λ¥

### 7-2. ν‚¤ λ΅ν…μ΄μ…(κµμ²΄) ν™μ©
- μ •κΈ°μ μΌλ΅ ν‚¤λ¥Ό κµμ²΄ν•μ—¬ λ³΄μ• κ°•ν™”
- κ³ κ° κ΄€λ¦¬ν• ν‚¤λ” μλ™ λ΅ν…μ΄μ… μ„¤μ • κ°€λ¥

### 7-3. κ¶ν• μµμ†ν™” μ›μΉ™ μ μ©
- ν‚¤μ— μ ‘κ·Όν•  μ μλ” μ‚¬μ©μ/μ„λΉ„μ¤λ¥Ό μµμ†ν™”
- IAM, ν‚¤ μ •μ±…, κ·ΈλνΈ λ“± κ¶ν• κ΄€λ¦¬ μ² μ €ν!

### 7-4. CloudTrailλ΅ λ¨λ‹ν„°λ§
- ν‚¤ μ‚¬μ© μ΄λ ¥μ„ CloudTrailλ΅ λ¨λ‹ν„°λ§ν•μ—¬ μ΄μƒ μ§•ν›„ νƒμ§€

---

## 8. μ‹¤μ „! KMS μ‚¬μ© μμ  π’»

### 8-1. AWS CLIλ΅ KMS ν‚¤ μƒμ„±ν•κΈ°
```bash
aws kms create-key --description "ν…μ¤νΈμ© KMS ν‚¤" --key-usage ENCRYPT_DECRYPT --origin AWS_KMS
```

### 8-2. λ°μ΄ν„° μ•”νΈν™”/λ³µνΈν™”
```bash
# λ°μ΄ν„° ν‚¤ μƒμ„±
aws kms generate-data-key --key-id <ν‚¤ID> --key-spec AES_256

# λ°μ΄ν„° μ•”νΈν™”
openssl enc -aes-256-cbc -in plain.txt -out encrypted.txt -K <PlaintextDataKey> -iv <IV>

# λ°μ΄ν„° ν‚¤ λ³µνΈν™”
aws kms decrypt --ciphertext-blob fileb://encrypted_data_key --output text --query Plaintext
```

### 8-3. S3 λ²„ν‚·μ— KMS μ μ©ν•κΈ°
- S3 λ²„ν‚· μ†μ„±μ—μ„ "κΈ°λ³Έ μ•”νΈν™”"λ¥Ό KMSλ΅ μ„¤μ •
- κ°μ²΄ μ—…λ΅λ“ μ‹ μλ™ μ•”νΈν™” μ μ©

---

## 9. KMSμ κ³ΌκΈ κµ¬μ΅° π’Έ

- ν‚¤ μƒμ„±/λ³΄κ΄€: μ›”λ³„λ΅ μ†μ•΅ κ³ΌκΈ
- μ•”νΈν™”/λ³µνΈν™” μ”μ²­: μ”μ²­ κ±΄μμ— λ”°λΌ κ³ΌκΈ
- AWS Free Tier: μ›” 20,000κ±΄ λ¬΄λ£ μ κ³µ

μμ„Έν• μ”κΈμ€ [AWS κ³µμ‹ μ”κΈν‘](https://aws.amazon.com/ko/kms/pricing/) μ°Έκ³ !

---

## 10. KMSμ ν•κ³„μ™€ λ€μ• π¤·β€β™‚οΈ

### 10-1. KMSμ ν•κ³„
- λ¦¬μ „ λ‹¨μ„λ΅ ν‚¤ κ΄€λ¦¬ (λ¦¬μ „ κ°„ λ³µμ  λ¶κ°€)
- λ€λ‰μ μ•”νΈν™”/λ³µνΈν™” μ”μ²­ μ‹ λΉ„μ© μ¦κ°€
- μΌλ¶€ νΉμν• μ•”νΈν™” μ”κµ¬μ‚¬ν•­μ€ μ§€μ›ν•μ§€ μ•μ

### 10-2. λ€μ• μ„λΉ„μ¤
- AWS CloudHSM: ν•λ“μ›¨μ–΄ λ³΄μ• λ¨λ“ κΈ°λ° ν‚¤ κ΄€λ¦¬
- μμ²΄ ν‚¤ κ΄€λ¦¬ μ‹μ¤ν… κµ¬μ¶•


# AWS IAM 완전정복! ☁️🔐

안녕하세요! 오늘은 AWS를 사용하면서 절대 빼놓을 수 없는 서비스, 바로 IAM(Identity and Access Management)에 대해 깊이 있게 파헤쳐보려고 합니다. AWS를 처음 접하시는 분들도, 이미 사용하고 계신 분들도 IAM을 제대로 이해하면 보안과 관리가 훨씬 쉬워진다는 사실! 그럼 시작해볼까요? 😄

---

## 1. IAM이란 무엇인가요? 🤔

IAM은 'Identity and Access Management'의 약자로, 말 그대로 '신원 및 접근 관리'를 의미합니다. AWS 리소스에 누가, 언제, 어떤 권한으로 접근할 수 있는지를 제어하는 서비스입니다. 쉽게 말해, AWS의 문지기 역할을 한다고 볼 수 있죠! 🚪

### 1.1 왜 IAM이 중요한가요?

AWS는 다양한 서비스와 리소스를 제공합니다. 만약 모든 사용자가 모든 리소스에 접근할 수 있다면? 상상만 해도 아찔하죠! 😱 IAM을 통해 각 사용자에게 꼭 필요한 권한만 부여함으로써, 보안을 강화하고 실수로 인한 사고도 예방할 수 있습니다.

---

## 2. IAM의 주요 개념들 🧩

IAM을 이해하려면 몇 가지 핵심 용어를 알아야 해요.

### 2.1 사용자(User)

AWS 계정 내에서 실제로 리소스에 접근하는 사람 또는 애플리케이션을 의미합니다. 예를 들어, 개발자 김철수, 운영자 이영희, 혹은 EC2에서 돌아가는 애플리케이션 등이 될 수 있죠.

### 2.2 그룹(Group)

비슷한 역할을 하는 사용자들을 묶어놓은 집합입니다. 예를 들어, '개발팀', '운영팀' 등으로 그룹을 만들고, 해당 그룹에 권한을 부여하면 관리가 훨씬 쉬워집니다. 👨‍💻👩‍💻

### 2.3 역할(Role)

특정 작업을 수행할 때 임시로 부여되는 권한의 집합입니다. 예를 들어, EC2 인스턴스가 S3 버킷에 접근해야 할 때, EC2에 역할을 부여하면 됩니다. 사용자가 아닌 서비스나 애플리케이션에 권한을 줄 때 주로 사용합니다.

### 2.4 정책(Policy)

누가 무엇을 할 수 있는지 정의하는 문서입니다. JSON 형식으로 작성되며, '이 사용자는 S3 버킷을 읽을 수 있다', '이 그룹은 EC2 인스턴스를 시작할 수 있다'와 같은 규칙을 담고 있습니다.

---

## 3. IAM의 구조 한눈에 보기 👀

IAM은 계정(Account) 아래에 사용자, 그룹, 역할, 정책이 계층적으로 구성되어 있습니다. 아래 다이어그램을 참고해보세요!

```
AWS Account
├── User
│   └── Policy
├── Group
│   └── Policy
└── Role
    └── Policy
```

이렇게 계정 아래에 여러 사용자, 그룹, 역할이 존재하고, 각각에 정책을 부여할 수 있습니다.

---

## 4. IAM 사용자와 그룹 관리하기 🛠️

### 4.1 사용자 생성하기

1. AWS 콘솔에 로그인합니다.
2. 상단 검색창에 'IAM'을 입력하고 서비스로 이동합니다.
3. 좌측 메뉴에서 '사용자'를 클릭한 후, '사용자 추가' 버튼을 누릅니다.
4. 사용자 이름을 입력하고, 프로그래밍 방식 접근(Access key) 또는 콘솔 접근(비밀번호) 중 필요한 방식을 선택합니다.
5. 권한 설정 단계에서 기존 그룹에 추가하거나, 직접 정책을 연결할 수 있습니다.
6. 태그를 추가하고, 생성하면 끝!

> **팁:** 처음에는 최소 권한 원칙(Least Privilege Principle)을 지키는 것이 중요합니다. 꼭 필요한 권한만 부여하세요! 🔒

### 4.2 그룹 생성 및 관리

1. '그룹' 메뉴로 이동해 '그룹 생성'을 클릭합니다.
2. 그룹 이름을 정하고, 해당 그룹에 부여할 정책을 선택합니다.
3. 그룹에 사용자를 추가하면 끝!

이렇게 그룹을 활용하면, 여러 사용자에게 동일한 권한을 한 번에 부여할 수 있어 관리가 훨씬 편리해집니다.

---

## 5. IAM 역할(Role) 제대로 활용하기 🎭

### 5.1 역할이 필요한 이유

AWS에서는 EC2, Lambda, ECS 등 다양한 서비스가 서로 상호작용합니다. 이때, 각 서비스가 다른 리소스에 접근하려면 인증이 필요하죠. 이때 사용하는 것이 바로 '역할(Role)'입니다.

예를 들어, EC2 인스턴스가 S3 버킷에 파일을 저장해야 한다면, EC2에 S3 접근 권한이 있는 역할을 부여하면 됩니다. 이렇게 하면, 별도의 Access Key를 코드에 넣지 않아도 안전하게 리소스에 접근할 수 있습니다. 👍

### 5.2 역할 생성 방법

1. IAM 콘솔에서 '역할' 메뉴로 이동합니다.
2. '역할 생성'을 클릭합니다.
3. 역할을 사용할 AWS 서비스(예: EC2, Lambda 등)를 선택합니다.
4. 역할에 부여할 정책을 선택합니다.
5. 역할 이름을 정하고 생성하면 끝!

---

## 6. 정책(Policy) 작성과 관리 📝

정책은 IAM의 핵심입니다. 정책을 잘 작성해야 보안도 지키고, 필요한 작업도 원활하게 할 수 있죠.

### 6.1 정책의 구조

정책은 JSON 형식으로 작성되며, 기본 구조는 다음과 같습니다.

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:ListBucket",
      "Resource": "arn:aws:s3:::example-bucket"
    }
  ]
}
```

- **Version**: 정책 언어의 버전(대부분 2012-10-17 사용)
- **Statement**: 하나 이상의 권한 선언
- **Effect**: Allow(허용) 또는 Deny(거부)
- **Action**: 허용/거부할 작업(예: s3:ListBucket)
- **Resource**: 정책이 적용될 리소스(ARN 형식)

### 6.2 정책 예시

- S3 버킷 읽기 전용 권한:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["s3:GetObject"],
      "Resource": "arn:aws:s3:::my-bucket/*"
    }
  ]
}
```

- EC2 인스턴스 시작/중지 권한:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["ec2:StartInstances", "ec2:StopInstances"],
      "Resource": "*"
    }
  ]
}
```

### 6.3 정책 연결 방법

정책은 사용자, 그룹, 역할에 연결할 수 있습니다. AWS에서 제공하는 '관리형 정책'을 사용할 수도 있고, 직접 '고객 관리형 정책'을 만들어 사용할 수도 있습니다.
️

---

## 7. MFA(Multi-Factor Authentication)로 보안 강화하기 🔐

IAM 사용자에게 MFA를 설정하면, 비밀번호 외에 추가 인증(예: OTP 앱, 하드웨어 토큰 등)이 필요해집니다. 

### 7.1 MFA 설정 방법

1. IAM 콘솔에서 사용자 선택
2. '보안 자격 증명' 탭에서 'MFA 장치 할당' 클릭
3. 가상 MFA(앱), U2F 보안 키, 하드웨어 MFA 중 선택
4. 안내에 따라 설정 완료!

---

## 8. IAM Best Practices 🌟

AWS 공식 문서와 실무 경험을 바탕으로 한 IAM 관리 꿀팁을 정리해봤어요!

1. **최소 권한 원칙(Least Privilege Principle)**: 꼭 필요한 권한만 부여하세요.
2. **루트 계정 사용 자제**: 루트 계정은 계정 생성 및 결제 등 특수한 경우에만 사용하고, 평소에는 IAM 사용자로 작업.
3. **MFA 필수 설정**: 모든 사용자와 루트 계정에 MFA를 설정.
4. **정기적인 권한 검토**: 주기적으로 정책과 권한을 점검해 불필요한 권한을 제거.
5. **액세스 키 관리**: 오래된 액세스 키는 비활성화하거나 삭제.
6. **로그 활성화**: CloudTrail 등 로그 서비스를 활성화해 누가 어떤 작업을 했는지 추적.
7. **정책 버전 관리**: 정책을 자주 수정한다면, 버전을 관리해 변경 이력을 남기기.

---

## 9. IAM과 관련된 실수들 😅

실제로 AWS를 사용하다 보면 IAM 설정 실수로 인해 곤란을 겪는 경우가 많아요. 대표적인 사례를 소개합니다.

- **모든 권한을 부여하는 정책 사용**: `Action: "*"`, `Resource: "*"`와 같이 모든 권한을 부여하면, 보안 사고의 원인이 될 수 있습니다.
- **루트 계정으로 모든 작업 수행**: 루트 계정은 해킹당하면 치명적입니다. 꼭 필요한 경우에만 사용하세요.
- **MFA 미설정**: MFA를 설정하지 않으면, 비밀번호 유출 시 바로 계정이 털릴 수 있습니다.
- **정책 오타**: JSON 문법 오류나 오타로 인해 정책이 제대로 적용되지 않는 경우가 많으니, 정책 생성 후 꼭 테스트해보세요.

---

## 10. IAM과 연동되는 AWS 서비스들 🔗

IAM은 AWS의 거의 모든 서비스와 연동됩니다. 대표적으로는 다음과 같습니다.

- **EC2**: 인스턴스에 역할을 부여해 S3, DynamoDB 등 다른 서비스에 안전하게 접근
- **Lambda**: 함수 실행 시 필요한 권한만 부여
- **S3**: 버킷 정책과 IAM 정책을 조합해 세밀한 접근 제어
- **CloudFormation**: 스택 생성/수정 시 필요한 권한 부여
- **ECS/EKS**: 컨테이너 오케스트레이션 시 역할 기반 권한 관리

---

## 11. IAM 정책 시뮬레이터 활용하기 🧪

정책을 작성한 후, 실제로 의도한 대로 동작하는지 확인하려면 'IAM 정책 시뮬레이터'를 활용해보세요. AWS 콘솔에서 제공하며, 정책이 특정 작업을 허용/거부하는지 미리 테스트할 수 있습니다.

---

## 12. IAM을 공부할 때 참고하면 좋은 자료들 📚

- [AWS 공식 IAM 문서](https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/introduction.html)
- [AWS IAM Best Practices](https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/best-practices.html)
- [AWS 정책 생성기](https://awspolicygen.s3.amazonaws.com/policygen.html)
- [IAM 정책 시뮬레이터](https://policysim.aws.amazon.com/)
- [AWS Security Blog](https://aws.amazon.com/ko/blogs/security/)



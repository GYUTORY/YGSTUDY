# ğŸ³ AWS ECR (Elastic Container Registry)

> **ğŸ“– ì´ ë¬¸ì„œëŠ” AWS ECRì„ ì²˜ìŒ ì ‘í•˜ëŠ” ë¶„ë“¤ì„ ìœ„í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.**

---

## ğŸ“‹ ëª©ì°¨
- [1. AWS ECRì´ë€?](#1-aws-ecrì´ë€)
- [2. ê¸°ë³¸ ìš©ì–´ ì •ë¦¬](#2-ê¸°ë³¸-ìš©ì–´-ì •ë¦¬)
- [3. ECRì˜ í•µì‹¬ ê°œë…](#3-ecrì˜-í•µì‹¬-ê°œë…)
- [4. ECR ì‚¬ìš© ì˜ˆì œ](#4-ecr-ì‚¬ìš©-ì˜ˆì œ)
- [5. ECRê³¼ CI/CD ì—°ë™](#5-ecrê³¼-cicd-ì—°ë™)
- [6. ECR ë¹„ìš© ë° ë³´ì•ˆ](#6-ecr-ë¹„ìš©-ë°-ë³´ì•ˆ)
- [7. ê²°ë¡ ](#7-ê²°ë¡ )

---

## 1. AWS ECRì´ë€? ğŸ¤”

### ğŸ’¡ ECRì´ ë¬´ì—‡ì¸ê°€ìš”?
**AWS ECR (Elastic Container Registry)**ëŠ” Amazon Web Servicesì—ì„œ ì œê³µí•˜ëŠ” ì™„ì „ê´€ë¦¬í˜• **Docker ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì €ì¥ì†Œ**ì…ë‹ˆë‹¤.

### ğŸ  ì‰½ê²Œ ë¹„ìœ í•˜ë©´...
ECRì€ **"Docker ì´ë¯¸ì§€ë“¤ì„ ë³´ê´€í•˜ëŠ” ì•„ë§ˆì¡´ ì°½ê³ "**ë¼ê³  ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
- ğŸª **ì¼ë°˜ ì°½ê³ **: ë¬¼ê±´ì„ ë³´ê´€í•˜ëŠ” ê³³
- ğŸ³ **ECR**: Docker ì´ë¯¸ì§€ë¥¼ ë³´ê´€í•˜ëŠ” ê³³

### ğŸ¯ ECRì´ í•„ìš”í•œ ì´ìœ 
1. **ê°œë°œí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì–´ë””ì— ë³´ê´€í• ê¹Œ?**
2. **íŒ€ì›ë“¤ê³¼ ì–´ë–»ê²Œ ê³µìœ í• ê¹Œ?**
3. **ë°°í¬í•  ë•Œ ì–´ë–»ê²Œ ê°€ì ¸ì˜¬ê¹Œ?**

ì´ ëª¨ë“  ë¬¸ì œë¥¼ ECRì´ í•´ê²°í•´ì¤ë‹ˆë‹¤!

---

## 2. ê¸°ë³¸ ìš©ì–´ ì •ë¦¬ ğŸ“š

### ğŸ³ Dockerë€?
- **ì»¨í…Œì´ë„ˆ ê¸°ìˆ **: ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë…ë¦½ì ì¸ í™˜ê²½ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê¸°ìˆ 
- **ì´ë¯¸ì§€**: ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì‹¤í–‰ í™˜ê²½ì„ íŒ¨í‚¤ì§€ë¡œ ë§Œë“  ê²ƒ
- **ì»¨í…Œì´ë„ˆ**: ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•œ ìƒíƒœ

### ğŸ—ï¸ CI/CDë€?
- **CI (Continuous Integration)**: ì½”ë“œë¥¼ ì§€ì†ì ìœ¼ë¡œ í†µí•©í•˜ëŠ” ê³¼ì •
- **CD (Continuous Deployment)**: ì½”ë“œë¥¼ ì§€ì†ì ìœ¼ë¡œ ë°°í¬í•˜ëŠ” ê³¼ì •

### ğŸ” IAMì´ë€?
- **AWS Identity and Access Management**: AWSì—ì„œ ì‚¬ìš©ì ê¶Œí•œì„ ê´€ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤

---

## 3. ECRì˜ í•µì‹¬ ê°œë… ğŸ“¦

### ğŸ¢ ë ˆì§€ìŠ¤íŠ¸ë¦¬ (Registry)
- **ì •ì˜**: ECRì˜ ì „ì²´ ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤
- **ë¹„ìœ **: ì•„ë§ˆì¡´ ì°½ê³  ì „ì²´ ê±´ë¬¼

### ğŸ“ ë¦¬í¬ì§€í„°ë¦¬ (Repository)
- **ì •ì˜**: Docker ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ëŠ” í´ë”
- **ë¹„ìœ **: ì°½ê³  ì•ˆì˜ íŠ¹ì • êµ¬ì—­ (ì˜ˆ: ì „ìì œí’ˆ êµ¬ì—­, ì˜ë¥˜ êµ¬ì—­)

### ğŸ–¼ï¸ ì´ë¯¸ì§€ (Image)
- **ì •ì˜**: ì‹¤í–‰ ê°€ëŠ¥í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ íŒ¨í‚¤ì§€
- **ë¹„ìœ **: ì°½ê³ ì— ë³´ê´€ë˜ëŠ” ìƒí’ˆ

### ğŸ·ï¸ íƒœê·¸ (Tag)
- **ì •ì˜**: ì´ë¯¸ì§€ ë²„ì „ì„ êµ¬ë¶„í•˜ëŠ” ë¼ë²¨
- **ë¹„ìœ **: ìƒí’ˆì˜ ëª¨ë¸ëª…ì´ë‚˜ ë²„ì „ (ì˜ˆ: iPhone 14, iPhone 15)

### ğŸ“‹ ìš©ì–´ ì •ë¦¬ í‘œ
| ìš©ì–´ | ì„¤ëª… | ë¹„ìœ  |
|------|------|------|
| Registry | ECR ì „ì²´ ì„œë¹„ìŠ¤ | ì°½ê³  ì „ì²´ ê±´ë¬¼ |
| Repository | ì´ë¯¸ì§€ ì €ì¥ í´ë” | ì°½ê³  ë‚´ íŠ¹ì • êµ¬ì—­ |
| Image | ì‹¤í–‰ ê°€ëŠ¥í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ | ì°½ê³ ì— ë³´ê´€ë˜ëŠ” ìƒí’ˆ |
| Tag | ì´ë¯¸ì§€ ë²„ì „ êµ¬ë¶„ | ìƒí’ˆì˜ ëª¨ë¸ëª…/ë²„ì „ |

---

## 4. ECR ì‚¬ìš© ì˜ˆì œ ğŸ› ï¸

### ğŸ¯ ëª©í‘œ
ê°„ë‹¨í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ECRì— ì—…ë¡œë“œí•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê³¼ì •ì„ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.

### ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­
1. **AWS ê³„ì •**ì´ í•„ìš”í•©ë‹ˆë‹¤
2. **AWS CLI** ì„¤ì¹˜ ë° êµ¬ì„±
3. **Docker** ì„¤ì¹˜ ë° ì‹¤í–‰

> **ğŸ’¡ AWS CLIë€?**
> AWS ì„œë¹„ìŠ¤ë¥¼ ëª…ë ¹ì¤„ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

> **ğŸ’¡ Dockerë€?**
> ì»¨í…Œì´ë„ˆ ê¸°ìˆ ë¡œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë…ë¦½ì ì¸ í™˜ê²½ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

---

### ğŸ“‚ 4.1 ECR ë¦¬í¬ì§€í„°ë¦¬ ìƒì„±
```bash
aws ecr create-repository --repository-name my-app-repo
```

**ğŸ¤” ì´ ëª…ë ¹ì–´ê°€ í•˜ëŠ” ì¼:**
- ECRì— "my-app-repo"ë¼ëŠ” ì´ë¦„ì˜ ì €ì¥ì†Œë¥¼ ë§Œë“­ë‹ˆë‹¤
- ë§ˆì¹˜ ì°½ê³ ì— ìƒˆë¡œìš´ êµ¬ì—­ì„ ë§Œë“œëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤

**ğŸ“ ê²°ê³¼:**
- ë¦¬í¬ì§€í„°ë¦¬ê°€ ìƒì„±ë©ë‹ˆë‹¤
- ë¦¬í¬ì§€í„°ë¦¬ URIê°€ ë°˜í™˜ë©ë‹ˆë‹¤ (ì˜ˆ: `123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/my-app-repo`)

---

### ğŸ“¦ 4.2 Docker ì´ë¯¸ì§€ ë¹Œë“œ
```bash
docker build -t my-app .
```

**ğŸ¤” ì´ ëª…ë ¹ì–´ê°€ í•˜ëŠ” ì¼:**
- í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ ì½”ë“œë¥¼ Docker ì´ë¯¸ì§€ë¡œ ë§Œë“­ë‹ˆë‹¤
- `-t my-app`: ì´ë¯¸ì§€ ì´ë¦„ì„ "my-app"ìœ¼ë¡œ ì§€ì •
- `.`: í˜„ì¬ ë””ë ‰í† ë¦¬ë¥¼ ë¹Œë“œ ì»¨í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš©

**ğŸ“ ê²°ê³¼:**
- ë¡œì»¬ì— "my-app"ì´ë¼ëŠ” Docker ì´ë¯¸ì§€ê°€ ìƒì„±ë©ë‹ˆë‹¤

---

### ğŸ”‘ 4.3 ECR ì¸ì¦ (ë¡œê·¸ì¸)
```bash
aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com
```

**ğŸ¤” ì´ ëª…ë ¹ì–´ê°€ í•˜ëŠ” ì¼:**
- AWS ECRì— ë¡œê·¸ì¸í•©ë‹ˆë‹¤
- ë§ˆì¹˜ ì°½ê³ ì— ë“¤ì–´ê°€ê¸° ì „ì— ì¶œì…ì¦ì„ ë°›ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤

**ğŸ“ ì£¼ì˜ì‚¬í•­:**
- `<AWS_ACCOUNT_ID>`ë¥¼ ì‹¤ì œ AWS ê³„ì • IDë¡œ ë°”ê¿”ì•¼ í•©ë‹ˆë‹¤
- `ap-northeast-2`ëŠ” ì„œìš¸ ë¦¬ì „ì…ë‹ˆë‹¤

---

### ğŸš€ 4.4 Docker ì´ë¯¸ì§€ ECR í‘¸ì‹œ
```bash
# 1ë‹¨ê³„: ì´ë¯¸ì§€ì— íƒœê·¸ ì§€ì •
docker tag my-app:latest <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com/my-app-repo

# 2ë‹¨ê³„: ECRì— ì´ë¯¸ì§€ ì—…ë¡œë“œ
docker push <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com/my-app-repo
```

**ğŸ¤” ì´ ê³¼ì •ì´ í•˜ëŠ” ì¼:**
1. **íƒœê·¸ ì§€ì •**: ë¡œì»¬ ì´ë¯¸ì§€ì— ECR ì£¼ì†Œë¥¼ ë¶™ì…ë‹ˆë‹¤
2. **ì—…ë¡œë“œ**: ECRì— ì´ë¯¸ì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤

**ğŸ“ ë¹„ìœ :**
- ì°½ê³ ì— ìƒí’ˆì„ ë³´ë‚¼ ë•Œ ì£¼ì†Œë¥¼ ë¶™ì´ê³  ë°°ì†¡í•˜ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤

---

### ğŸ“¥ 4.5 ECRì—ì„œ Docker ì´ë¯¸ì§€ Pull
```bash
docker pull <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com/my-app-repo:latest
```

**ğŸ¤” ì´ ëª…ë ¹ì–´ê°€ í•˜ëŠ” ì¼:**
- ECRì—ì„œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤
- ë§ˆì¹˜ ì°½ê³ ì—ì„œ ìƒí’ˆì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤

---

## 5. ECRê³¼ CI/CD ì—°ë™ ğŸ› ï¸

### ğŸ¯ CI/CDë€?
**CI/CD**ëŠ” ê°œë°œìê°€ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³  ë°°í¬í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.

### ğŸ“‹ CI/CDì˜ ì¥ì 
1. **ìë™í™”**: ìˆ˜ë™ ì‘ì—…ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤
2. **ì¼ê´€ì„±**: í•­ìƒ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë°°í¬ë©ë‹ˆë‹¤
3. **ë¹ ë¥¸ ë°°í¬**: ì½”ë“œ ë³€ê²½ ì‹œ ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤

---

### ğŸ”„ GitHub Actionsì™€ AWS ECR ì—°ë™ ì˜ˆì œ

```yaml
name: Deploy to ECR

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # 1ë‹¨ê³„: ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      - name: Checkout repository
        uses: actions/checkout@v2

      # 2ë‹¨ê³„: AWS ì¸ì¦ ì„¤ì •
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ap-northeast-2

      # 3ë‹¨ê³„: ECR ë¡œê·¸ì¸
      - name: Login to Amazon ECR
        run: |
          aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com

      # 4ë‹¨ê³„: ì´ë¯¸ì§€ ë¹Œë“œ ë° ì—…ë¡œë“œ
      - name: Build and Push Docker Image
        run: |
          docker build -t my-app .
          docker tag my-app:latest <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com/my-app-repo
          docker push <AWS_ACCOUNT_ID>.dkr.ecr.ap-northeast-2.amazonaws.com/my-app-repo
```

**ğŸ¤” ì´ ê³¼ì •ì´ í•˜ëŠ” ì¼:**
1. **ì½”ë“œ ë³€ê²½ ê°ì§€**: GitHubì— ì½”ë“œê°€ ì˜¬ë¼ì˜¤ë©´ ìë™ìœ¼ë¡œ ì‹œì‘
2. **AWS ì¸ì¦**: ECRì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œ ì„¤ì •
3. **ECR ë¡œê·¸ì¸**: ECRì— ë¡œê·¸ì¸
4. **ë¹Œë“œ ë° ì—…ë¡œë“œ**: Docker ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ê³  ECRì— ì—…ë¡œë“œ

---

## 6. ECR ë¹„ìš© ë° ë³´ì•ˆ ğŸ’°ğŸ”’

### ğŸ’° ë¹„ìš© êµ¬ì¡°
ECRì˜ ë¹„ìš©ì€ í¬ê²Œ ë‘ ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤:

#### ğŸ“¦ ì €ì¥ ë¹„ìš©
- **ê³¼ê¸ˆ ê¸°ì¤€**: ì €ì¥ëœ ì´ë¯¸ì§€ì˜ í¬ê¸°
- **ë¹„ìš©**: GBë‹¹ ì›” ìš”ê¸ˆ
- **ì˜ˆì‹œ**: 1GB ì´ë¯¸ì§€ë¥¼ 1ê°œì›” ë³´ê´€í•˜ë©´ ì•½ $0.10

#### ğŸ“¡ ë°ì´í„° ì „ì†¡ ë¹„ìš©
- **ê³¼ê¸ˆ ê¸°ì¤€**: ì¸í„°ë„·ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì „ì†¡í•  ë•Œ
- **ë¹„ìš©**: GBë‹¹ ì „ì†¡ ìš”ê¸ˆ
- **ì˜ˆì‹œ**: 1GB ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ë©´ ì•½ $0.09

> **ğŸ’¡ íŒ: ê°™ì€ ë¦¬ì „ ë‚´ì—ì„œëŠ” ë°ì´í„° ì „ì†¡ ë¹„ìš©ì´ ë¬´ë£Œì…ë‹ˆë‹¤!**

---

### ğŸ”’ ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€

#### 1ï¸âƒ£ IAM ì •ì±… ìµœì†Œ ê¶Œí•œ ì„¤ì •
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "ecr:GetAuthorizationToken",
                "ecr:BatchCheckLayerAvailability",
                "ecr:GetDownloadUrlForLayer",
                "ecr:BatchGetImage"
            ],
            "Resource": "*"
        }
    ]
}
```

#### 2ï¸âƒ£ VPC ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©
- **ëª©ì **: ì¸í„°ë„·ì„ ê±°ì¹˜ì§€ ì•Šê³  AWS ë‚´ë¶€ì—ì„œë§Œ í†µì‹ 
- **ì¥ì **: ë³´ì•ˆ ê°•í™” ë° ë¹„ìš© ì ˆì•½

#### 3ï¸âƒ£ ì´ë¯¸ì§€ ìŠ¤ìº” í™œì„±í™”
- **ëª©ì **: ë³´ì•ˆ ì·¨ì•½ì  ìë™ ê²€ì‚¬
- **ì¥ì **: ì•ˆì „í•œ ì´ë¯¸ì§€ ë³´ì¥

---

## 7. ê²°ë¡  âœ…

### ğŸ¯ ECRì˜ í•µì‹¬ ê°€ì¹˜
1. **ì™„ì „ê´€ë¦¬í˜•**: ì¸í”„ë¼ ê´€ë¦¬ ì—†ì´ ì‚¬ìš© ê°€ëŠ¥
2. **ê³ ê°€ìš©ì„±**: AWSì˜ ê¸€ë¡œë²Œ ì¸í”„ë¼ í™œìš©
3. **ë³´ì•ˆ ê°•í™”**: IAM ê¸°ë°˜ ì ‘ê·¼ ì œì–´
4. **CI/CD í†µí•©**: ìë™í™”ëœ ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

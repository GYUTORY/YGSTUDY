---
title: 시스템 설계 및 아키텍처 패턴 (Professional Edition)
tags: [system-design, architecture, scalability, distributed-systems]
updated: 2025-12-17
---

# 시스템 설계 및 아키텍처 패턴 – 실무 기준 정리

> 본 문서는 **프로덕션 환경을 전제로 한 시스템 설계 의사결정 가이드**입니다.  
> 이론 나열이 아닌, *왜 이 선택을 하는가*, *언제 문제가 되는가*, *운영에서 무엇을 본다*를 중심으로 작성되었습니다.

---

## 1. 시스템 설계의 본질

시스템 설계의 목적은 단순히 “동작하는 시스템”이 아니라 다음을 만족하는 구조를 만드는 것입니다.

- 예측 가능한 성능
- 장애 시 통제 가능한 영향 범위
- 트래픽 증가 시 구조 변경 없이 대응 가능
- 인력 교체·확장에도 유지 가능한 복잡도

> **좋은 설계는 코드보다 오래 남고, 나쁜 설계는 사람을 태운다.**

---

## 2. 핵심 설계 원칙 (Production Grade)

### 2.1 단순성 우선 원칙

- 복잡성은 *필요해질 때* 추가합니다.
- 초기부터 마이크로서비스, 서비스 메시를 도입하는 것은 대부분 과잉 설계입니다.

**권장 진화 경로**
```
Monolith
 → Modular Monolith
 → Service Separation
 → Microservices (필요 시)
```

---

### 2.2 확장성(Scalability)의 실체

확장성은 “서버를 늘릴 수 있다”가 아닙니다.

| 항목 | 진짜 의미 |
|---|---|
| Scale Out | 상태를 외부로 밀어냈는가 |
| Scale Up | 장애 시 복구 전략이 있는가 |
| Auto Scaling | Scale-In 시 데이터 손실이 없는가 |

**실무 결론**
- App Server: 수평 확장
- Cache / MQ: 수평 확장
- DB Write Node: 제한적 수직 확장 + 샤딩 준비

---

## 3. CAP 정리의 실무적 해석

> **현실의 분산 시스템은 항상 P를 가진다.**

따라서 선택지는 두 가지뿐입니다.

| 선택 | 의미 |
|---|---|
| CP | 정확하지만 멈출 수 있음 |
| AP | 계속 동작하지만 틀릴 수 있음 |

### 3.1 CP를 선택해야 하는 영역
- 결제
- 재고
- 예약
- 권한/인증

### 3.2 AP를 선택해야 하는 영역
- 로그
- 알림
- 피드
- 통계

> 하나의 시스템 안에서도 **도메인별로 CAP 선택은 달라져야 합니다.**

---

## 4. 로드 밸런싱 설계 기준

### 4.1 L4 vs L7 선택 기준

| 기준 | L4 | L7 |
|---|---|---|
| 성능 | 매우 우수 | 상대적으로 느림 |
| 라우팅 | IP/Port | Header/Path |
| 운영 난이도 | 낮음 | 높음 |
| 마이크로서비스 | 부적합 | 적합 |

**현실적인 구조**
```
[ L4 (NLB) ]
      ↓
[ L7 (ALB / Nginx) ]
      ↓
[ App ]
```

---

## 5. 분산 락과 동시성 제어 전략

### 5.1 분산 락이 필요한 경우

- 수량 차감
- 중복 처리 방지
- 배치 단일 실행 보장

### 5.2 Redis 락의 현실

| 항목 | 주의 |
|---|---|
| TTL | 반드시 설정 |
| Unlock | Lua Script 필수 |
| 장애 | Redis 장애 시 전체 영향 |

**중요 결론**
> Redis 락은 **정합성 도구가 아니라 충돌 완화 도구**입니다.

---

## 6. 캐싱 전략의 실제 기준

### 6.1 캐시는 구조다

```
L1: In-Memory (Process)
L2: Redis
L3: CDN
L4: DB Buffer
```

### 6.2 실패하는 캐시 패턴

- 무효화 전략 없음
- TTL만 믿음
- Write-Behind 남용

### 6.3 성공하는 캐시의 특징

- 삭제 기준이 명확
- 갱신 경로 단일화
- 캐시 미스 시 DB 보호 로직 존재

---

## 7. 데이터베이스 샤딩 판단 기준

### 7.1 “샤딩이 필요한 시점”

- 단일 테이블 Row 수 수천만 이상
- 인덱스가 RAM에 안 올라감
- Write Lock 경합 증가

### 7.2 샤딩 전 체크리스트

- 쿼리 패턴이 Key 기반인가?
- Cross-Shard Join이 필요한가?
- 운영 인력이 감당 가능한가?

> **샤딩은 성능 문제가 아니라 조직 문제입니다.**

---

## 8. 실전 아키텍처 사례 요약

### SNS
- AP 선택
- Fan-out 비동기
- Timeline Precompute

### 결제
- CP 선택
- 트랜잭션 우선
- 장애 시 Fail Fast

### IoT / 실시간 시스템
- Event Driven
- MQ 중심
- 재처리 가능 구조

---

## 9. 운영 관점에서 반드시 보는 지표

| 영역 | 핵심 지표 |
|---|---|
| 안정성 | Error Rate, Retry |
| 성능 | P95, P99 |
| 확장 | Scale 시간 |
| 비용 | 요청당 비용 |

---

## 10. 최종 결론

- 설계는 기술 문제가 아니라 **판단 문제**
- 모든 선택에는 비용이 따른다
- 완벽한 구조는 없다
- **변경 비용이 낮은 구조가 최고의 구조다**

---

## 참고 문헌

- Designing Data-Intensive Applications
- AWS Well-Architected Framework
- Martin Fowler – Architecture
- Google SRE Book

---

문서 작성일: 2025-12-16

syntax = "proto3";

package order;

// 주문 서비스 정의
service OrderService {
  // 주문 생성
  rpc CreateOrder(CreateOrderRequest) returns (CreateOrderResponse);
  
  // 주문 조회
  rpc GetOrder(GetOrderRequest) returns (GetOrderResponse);
  
  // 사용자 주문 목록 조회
  rpc GetUserOrders(GetUserOrdersRequest) returns (GetUserOrdersResponse);
  
  // 주문 상태 업데이트
  rpc UpdateOrderStatus(UpdateOrderStatusRequest) returns (UpdateOrderStatusResponse);
  
  // 주문 취소
  rpc CancelOrder(CancelOrderRequest) returns (CancelOrderResponse);
  
  // 주문 아이템 추가
  rpc AddOrderItem(AddOrderItemRequest) returns (AddOrderItemResponse);
  
  // 주문 아이템 제거
  rpc RemoveOrderItem(RemoveOrderItemRequest) returns (RemoveOrderItemResponse);
}

// 요청 메시지들
message CreateOrderRequest {
  string user_id = 1;
  repeated OrderItem items = 2;
  Address shipping_address = 3;
  string payment_method = 4;
  string notes = 5;
}

message GetOrderRequest {
  string order_id = 1;
}

message GetUserOrdersRequest {
  string user_id = 1;
  int32 page = 2;
  int32 limit = 3;
  string status = 4;
}

message UpdateOrderStatusRequest {
  string order_id = 1;
  string status = 2;
  string notes = 3;
}

message CancelOrderRequest {
  string order_id = 1;
  string reason = 2;
}

message AddOrderItemRequest {
  string order_id = 1;
  OrderItem item = 2;
}

message RemoveOrderItemRequest {
  string order_id = 1;
  string item_id = 2;
}

// 응답 메시지들
message CreateOrderResponse {
  bool success = 1;
  string message = 2;
  Order order = 3;
}

message GetOrderResponse {
  bool success = 1;
  string message = 2;
  Order order = 3;
}

message GetUserOrdersResponse {
  bool success = 1;
  string message = 2;
  repeated Order orders = 3;
  PaginationInfo pagination = 4;
}

message UpdateOrderStatusResponse {
  bool success = 1;
  string message = 2;
  Order order = 3;
}

message CancelOrderResponse {
  bool success = 1;
  string message = 2;
  Order order = 3;
}

message AddOrderItemResponse {
  bool success = 1;
  string message = 2;
  Order order = 3;
}

message RemoveOrderItemResponse {
  bool success = 1;
  string message = 2;
  Order order = 3;
}

// 데이터 모델들
message Order {
  string id = 1;
  string user_id = 2;
  repeated OrderItem items = 3;
  OrderStatus status = 4;
  Address shipping_address = 5;
  string payment_method = 6;
  double total_amount = 7;
  double tax_amount = 8;
  double shipping_cost = 9;
  string notes = 10;
  string created_at = 11;
  string updated_at = 12;
  string shipped_at = 13;
  string delivered_at = 14;
  string cancelled_at = 15;
  string cancellation_reason = 16;
}

message OrderItem {
  string id = 1;
  string product_id = 2;
  string product_name = 3;
  int32 quantity = 4;
  double unit_price = 5;
  double total_price = 6;
  string description = 7;
  string image_url = 8;
}

message Address {
  string street = 1;
  string city = 2;
  string state = 3;
  string zip_code = 4;
  string country = 5;
  string phone = 6;
}

enum OrderStatus {
  PENDING = 0;
  CONFIRMED = 1;
  PROCESSING = 2;
  SHIPPED = 3;
  DELIVERED = 4;
  CANCELLED = 5;
  REFUNDED = 6;
}

message PaginationInfo {
  int32 page = 1;
  int32 limit = 2;
  int32 total = 3;
  int32 total_pages = 4;
}
